{"componentChunkName":"component---src-templates-blog-post-js","path":"/27/","result":{"data":{"site":{"siteMetadata":{"author":"weijiew","homeCity":"China"}},"markdownRemark":{"html":"<h1>1. 环境</h1>\n<p>WSL + Hadoop </p>\n<ol>\n<li>需要单独创建 Hadoop 用户。</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">useradd</span> -m hadoop -s /bin/bash  <span class=\"token comment\">#创建hadoop用户，并使用/bin/bash作为shell</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">passwd</span> hadoop                   <span class=\"token comment\">#为hadoop用户设置密码</span>\n<span class=\"token function\">sudo</span> adduser hadoop <span class=\"token function\">sudo</span>             <span class=\"token comment\">#为hadoop用户增加管理员权限</span>\n<span class=\"token function\">su</span> - hadoop                          <span class=\"token comment\">#切换当前用户为用户hadoop</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update                  <span class=\"token comment\">#更新hadoop用户</span></code></pre></div>\n<h1>2. 配置 Java 环境</h1>\n<p>首先安装 JDK ，需要申请账户，<a href=\"https://www.oracle.com/java/technologies/javase-downloads.html\">jdk-8u261-linux-x64.tar.gz</a>  。</p>\n<p>创建文件夹，用于存放 JDK </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">su</span> <span class=\"token comment\"># 切换到超级用户， hadoop 没有权限创建文件夹 </span>\n<span class=\"token function\">mkdir</span> /usr/lib/jvm</code></pre></div>\n<p>解压到 /usr/lib/jvm 目录下，注意中间的路径需要设置成自己的文件所在位置。我的所在 F 盘中。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo tar zxvf /mnt/f/jdk-8u261-linux-x64.tar.gz -C /usr/lib/jvm</code></pre></div>\n<p>将文件 jdk1.8.0_261 重命名为 java 。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd /usr/lib/jvm\nmv  jdk1.8.0_261 java          </code></pre></div>\n<p>切换到 hadoop 用户下，修改配置文件。添加 Java 环境变量。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">su hadoop\nvim ~/.bashrc</code></pre></div>\n<p>在其中添加内容：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#Java Environment\nexport JAVA_HOME=/usr/lib/jvm/java\nexport JRE_HOME=${JAVA_HOME}/jre\nexport CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib\nexport PATH=${JAVA_HOME}/bin:$PATH</code></pre></div>\n<p>使得环境变量生效，并判断 Java 环境是否配置成功。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">source ~/.bashrc \njava -version </code></pre></div>\n<p>成功后会出现如下内容：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">hadoop@LAPTOP-PJ3DJQFQ:~$ java -version\njava version <span class=\"token string\">\"1.8.0_261\"</span>\nJava<span class=\"token punctuation\">(</span>TM<span class=\"token punctuation\">)</span> SE Runtime Environment <span class=\"token punctuation\">(</span>build <span class=\"token number\">1.8</span>.0_261-b12<span class=\"token punctuation\">)</span>\nJava HotSpot<span class=\"token punctuation\">(</span>TM<span class=\"token punctuation\">)</span> <span class=\"token number\">64</span>-Bit Server VM <span class=\"token punctuation\">(</span>build <span class=\"token number\">25.261</span>-b12, mixed mode<span class=\"token punctuation\">)</span></code></pre></div>\n<h1>3. 配置 Hadoop</h1>\n<p>下载地址：<a href=\"https://archive.apache.org/dist/hadoop/common/hadoop-3.2.1/hadoop-3.2.1.tar.gz\">hadoop-3.2.1.tar.gz</a></p>\n<p>将 Hadoop 解压到 /usr/local 目录下：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo tar -zxvf  /mnt/f/dowload/hadoop-3.2.1.tar.gz -C /usr/local</code></pre></div>\n<p>修改文件命名，并修改该文件的权限。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo mv  hadoop-3.2.1  hadoop\nsudo chown -R hadoop ./hadoop</code></pre></div>\n<p>添加环境变量。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim ~/.bashrc</code></pre></div>\n<p>添加内容如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#Hadoop Environment\nexport HADOOP_HOME=/usr/local/hadoop\nexport CLASSPATH=$($HADOOP_HOME/bin/hadoop classpath):$CLASSPATH\nexport HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native\nexport PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</code></pre></div>\n<p>使环境变量生效并判断是否成功。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">source</span> ~./bashrc\nhadoop version</code></pre></div>\n<p>出现如下内容表示配置成功。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">hadoop@LAPTOP-PJ3DJQFQ:~$ hadoop version\nHadoop <span class=\"token number\">3.2</span>.1\nSource code repository https://gitbox.apache.org/repos/asf/hadoop.git -r b3cbbb467e22ea829b3808f4b7b01d07e0bf3842\nCompiled by rohithsharmaks on <span class=\"token number\">2019</span>-09-10T15:56Z\nCompiled with protoc <span class=\"token number\">2.5</span>.0\nFrom <span class=\"token builtin class-name\">source</span> with checksum 776eaf9eee9c0ffc370bcbc1888737\nThis <span class=\"token builtin class-name\">command</span> was run using /usr/local/hadoop/share/hadoop/common/hadoop-common-3.2.1.jar</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim core-site.xml\nvim hdfs-site.xml</code></pre></div>\n<h1>4. 配置 SSH</h1>\n<p>在下载 ssh 之前需要将 wsl 内置的 ssh 卸载，因为内置的 ssh 有一些问题。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> remove openssh-server\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> remove openssh-client\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> openssh-server\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> openssh-client</code></pre></div>\n<p>WSL 和 windows 公用一套端口，22 端口已被 windows 中 TCP 占用。</p>\n<p>所以需要修改端口，可以修改成 23 ，修改方法如下。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">sed</span> -i <span class=\"token string\">'/Port /c Port 23'</span> /etc/ssh/sshd_config\n<span class=\"token function\">sudo</span> <span class=\"token function\">sed</span> -i <span class=\"token string\">'/ListenAddress 0.0.0.0/c ListenAddress 0.0.0.0'</span> /etc/ssh/sshd_config</code></pre></div>\n<p>我修改后依旧不生效，采用解决方法是直接设置端口参数。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> localhost -p <span class=\"token number\">23</span></code></pre></div>\n<p>可以成功访问，结果如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">hadoop@LAPTOP-PJ3DJQFQ:~$ <span class=\"token function\">ssh</span> localhost -p <span class=\"token number\">23</span>\nhadoop@localhost's password:\nWelcome to Ubuntu <span class=\"token number\">20.04</span>.1 LTS <span class=\"token punctuation\">(</span>GNU/Linux <span class=\"token number\">4.4</span>.0-18362-Microsoft x86_64<span class=\"token punctuation\">)</span>\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Sep <span class=\"token number\">16</span> 08:56:18 CST <span class=\"token number\">2020</span>\n\n  System load:    <span class=\"token number\">0.52</span>      Processes:              <span class=\"token number\">17</span>\n  Usage of /home: unknown   Users logged in:        <span class=\"token number\">0</span>\n  Memory usage:   <span class=\"token number\">52</span>%       IPv4 address <span class=\"token keyword\">for</span> eth0:  <span class=\"token number\">10.251</span>.235.217\n  Swap usage:     <span class=\"token number\">0</span>%        IPv4 address <span class=\"token keyword\">for</span> wifi2: <span class=\"token number\">192.168</span>.137.1\n\n\n<span class=\"token number\">30</span> updates can be installed immediately.\n<span class=\"token number\">5</span> of these updates are security updates.\nTo see these additional updates run: <span class=\"token function\">apt</span> list --upgradable\n\n\nLast login: Wed Sep <span class=\"token number\">16</span> 08:51:50 <span class=\"token number\">2020</span> from <span class=\"token number\">127.0</span>.0.1</code></pre></div>\n<p>需要密码访问，可以设置成不需要密码。首先退出 ssh 然后进入 .ssh 文件中生成密钥。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">exit</span> \n<span class=\"token builtin class-name\">cd</span> ~/.ssh/ \nssh-keygen -t rsa</code></pre></div>\n<p><code class=\"language-text\">ssh-keygen -t rsa</code> 命令过后需要敲击三次空格，第一次表示将 KEY 存于默认位置，第二三次都是确定 passpharse 。</p>\n<p>最终出现如下内容表示成功。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">hadoop@LAPTOP-PJ3DJQFQ:~/.ssh$ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter <span class=\"token function\">file</span> <span class=\"token keyword\">in</span> <span class=\"token function\">which</span> to save the key <span class=\"token punctuation\">(</span>/home/hadoop/.ssh/id_rsa<span class=\"token punctuation\">)</span>:\nEnter passphrase <span class=\"token punctuation\">(</span>empty <span class=\"token keyword\">for</span> no passphrase<span class=\"token punctuation\">)</span>:\nEnter same passphrase again:\nYour identification has been saved <span class=\"token keyword\">in</span> /home/hadoop/.ssh/id_rsa\nYour public key has been saved <span class=\"token keyword\">in</span> /home/hadoop/.ssh/id_rsa.pub\nThe key fingerprint is:\nSHA256:5WRr+wG0Vrb4/bRFKrA5gsWFbL5oj119L169+ITFJCQ hadoop@LAPTOP-PJ3DJQFQ\nThe key's randomart image is:\n+---<span class=\"token punctuation\">[</span>RSA <span class=\"token number\">3072</span><span class=\"token punctuation\">]</span>----+\n<span class=\"token operator\">|</span>           E <span class=\"token builtin class-name\">.</span>   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>       <span class=\"token builtin class-name\">.</span> <span class=\"token builtin class-name\">.</span>  o    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>        + * o. <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>       + B * .+  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>        S X <span class=\"token builtin class-name\">.</span>  o.<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>       + + O .oo.<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>      + o * <span class=\"token operator\">=</span>.+.<span class=\"token operator\">=</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     <span class=\"token builtin class-name\">.</span> + o o +<span class=\"token operator\">+=</span>+<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>      <span class=\"token builtin class-name\">.</span> o   .oo<span class=\"token operator\">=</span>o<span class=\"token operator\">|</span>\n+----<span class=\"token punctuation\">[</span>SHA256<span class=\"token punctuation\">]</span>-----+</code></pre></div>\n<p>通过后续的命令可以将密钥存入文本中实现不要密钥登陆。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">hadoop@LAPTOP-PJ3DJQFQ:~/.ssh$ <span class=\"token function\">touch</span> authorized_keys\nhadoop@LAPTOP-PJ3DJQFQ:~/.ssh$ <span class=\"token function\">chmod</span> <span class=\"token number\">600</span> authorized_keys\nhadoop@LAPTOP-PJ3DJQFQ:~/.ssh$ <span class=\"token function\">cat</span> ./id_rsa.pub <span class=\"token operator\">>></span> ./authorized_keys\nhadoop@LAPTOP-PJ3DJQFQ:~/.ssh$ <span class=\"token function\">ssh</span> localhost -p <span class=\"token number\">23</span>\nWelcome to Ubuntu <span class=\"token number\">20.04</span>.1 LTS <span class=\"token punctuation\">(</span>GNU/Linux <span class=\"token number\">4.4</span>.0-18362-Microsoft x86_64<span class=\"token punctuation\">)</span>\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Sep <span class=\"token number\">16</span> 09:02:55 CST <span class=\"token number\">2020</span>\n\n  System load:    <span class=\"token number\">0.52</span>      Processes:              <span class=\"token number\">17</span>\n  Usage of /home: unknown   Users logged in:        <span class=\"token number\">0</span>\n  Memory usage:   <span class=\"token number\">48</span>%       IPv4 address <span class=\"token keyword\">for</span> eth0:  <span class=\"token number\">10.251</span>.235.217\n  Swap usage:     <span class=\"token number\">0</span>%        IPv4 address <span class=\"token keyword\">for</span> wifi2: <span class=\"token number\">192.168</span>.137.1\n\n\n<span class=\"token number\">30</span> updates can be installed immediately.\n<span class=\"token number\">5</span> of these updates are security updates.\nTo see these additional updates run: <span class=\"token function\">apt</span> list --upgradable\n\n\nLast login: Wed Sep <span class=\"token number\">16</span> 08:56:18 <span class=\"token number\">2020</span> from <span class=\"token number\">127.0</span>.0.1</code></pre></div>\n<p>但是在执行 hadoop 时默认的启动端口依旧是 22 。所以需要修改为 23</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export HADOOP_SSH_OPTS=&quot;-p 23&quot;</code></pre></div>\n<p>添加完毕后依旧无法启动，需要添加 java 环境变量。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vim /usr/local/hadoop/etc/hadoop/hadoop-env.sh</code></pre></div>\n<p>将如下内容添加至其中： </p>\n<blockquote>\n<p>export JAVA_HOME=/usr/lib/jvm/java</p>\n</blockquote>\n<p>继续运行后出现如下错误</p>\n<blockquote>\n<p>2020-09-16 21:22:10,169 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform… using builtin-java classes where applicable</p>\n</blockquote>\n<p>因为是 WARN 级别，这个错误可以忽视。也可以在 hadoop-env.sh 文件中添加如下内容，错误消失。</p>\n<blockquote>\n<p>export HADOOP<em>OPTS=“-Djava.library.path=${HADOOP</em>HOME}/lib/native”</p>\n</blockquote>\n<p>启动 Hadoop 。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">hadoop@LAPTOP-PJ3DJQFQ:/usr/local/hadoop/etc/hadoop$ start-dfs.sh\nhadoop@LAPTOP-PJ3DJQFQ:/usr/local/hadoop/etc/hadoop$ jps\n3654 DataNode\n4328 Jps\n3802 SecondaryNameNode</code></pre></div>\n<h1>MYSQL 安装</h1>\n<h1>参考</h1>\n<ol>\n<li><a href=\"https://www.jianshu.com/p/1f138497df6c\">配置SSH</a></li>\n</ol>","excerpt":"1. 环境 WSL + Hadoop  需要单独创建 Hadoop 用户。 2. 配置 Java 环境 首先安装 JDK ，需要申请账户，jdk-8u261-linux-x64.tar.gz  。 创建文件夹，用于存放 JDK  解压到 /usr/lib/jvm…","fields":{"tagSlugs":["/tags/大数据/"]},"frontmatter":{"title":"Hadoop install","tags":["大数据"],"date":"September 14, 2020"}}},"pageContext":{"slug":"/27/"}}}