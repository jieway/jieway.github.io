---
title: 'å†™ä¸€ä¸ª Pascal è§£é‡Šå™¨å§ï¼'
date: '2021-02-13'
cta: 'ç¼–è¯‘åŽŸç†'
---

# 0. å‰è¨€

æœ€è¿‘å‘çŽ°äº†ä¸€ä¸ªå¾ˆæœ‰è¶£çš„[é¡¹ç›®](https://github.com/rspivak/lsbasi/)ï¼ŒåŠ ä¸Šç¼–è¯‘åŽŸç†è¿˜æœ‰æ²¡æœ‰è€ƒè¯•ã€‚æ‰€ä»¥èŠ±äº†ä¸¤ä¸ªæ˜ŸæœŸçš„æ—¶é—´æ¥åšï¼Œæ•´ä½“å†™ä¸‹æ¥æ”¶èŽ·å¾ˆå¤§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè¸©å‘è®°å½•ï¼Œä¸€äº›å¿ƒå¾—ä½“ä¼šä»¥åŠæ€»ç»“ã€‚

å†…å®¹æ¶µç›–äº†è¯æ³•åˆ†æžï¼Œè¯­æ³•åˆ†æžï¼Œè¯­ä¹‰åˆ†æžï¼Œé€’å½’ä¸‹é™åˆ†æžï¼ŒæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œä½œç”¨åŸŸï¼Œå‡½æ•°ï¼ŒæŠ¥é”™ä¿¡æ¯ï¼Œè°ƒç”¨æ ˆç­‰å†…å®¹ã€‚è¿™æ˜¯æˆ‘ç›®å‰èƒ½æƒ³åˆ°çš„ï¼Œé™¤æ­¤ä¹‹å¤–é‡Œé¢æœ‰å¾ˆå¤šç»†èŠ‚ä¸å†™ä»£ç æ˜¯ä½“ä¼šä¸åˆ°çš„ã€‚

æˆ‘çš„ä»£ç ï¼š[repo](https://github.com/weijiew/lsbasi) ã€‚

ä¸ºä»€ä¹ˆä¸å†™ C ç¼–è¯‘å™¨ï¼Œè€Œæ˜¯å†™ Pascal ï¼Ÿ 

æœ€åˆæˆ‘ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œè¿™ä¸ªç–‘é—®æ˜¯åœ¨çœ‹è§†é¢‘çš„æ—¶å€™å¾—åˆ°è§£ç­”çš„ã€‚ç­”æ¡ˆå¾ˆç®€å•å› ä¸º C çš„æˆåˆ†å¤æ‚ï¼Œè¯­æ³•ç»“æž„ä¸è§„æ•´ï¼Œä¸é€‚åˆåˆå­¦è€…ã€‚ä¸Žä¹‹ç›¸æ¯” Pascal å°±æ¯”è¾ƒè§„æ•´ï¼Œç®€å•ï¼Œå®žçŽ°èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚

ä¸‹é¢ä¸€äº›å»ºè®®ï¼Œåº”è¯¥å¯ä»¥å¸®ä½ èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚

1. ä¸€å®šè¦æŽŒæ¡è°ƒè¯•æŠ€å·§ä»¥åŠå¿«æ·é”®ï¼Œè·Ÿç€æµç¨‹èµ°ä¸€éå¾ˆå¤šé—®é¢˜è¿Žåˆƒè€Œè§£ã€‚

æˆ‘çš„çŽ¯å¢ƒæ˜¯ Win10ï¼ŒPycharmï¼ŒPython3.6 ã€‚ä¸‹é¢æ˜¯ Pycharm è°ƒè¯•å¿«æ·é”®ã€‚

ä¸€èˆ¬çš„è°ƒè¯•æ­¥éª¤ï¼šæ‰§è¡Œä»£ç ï¼ˆF8ï¼‰ => è·³å…¥å‡½æ•°ä¸­ï¼ˆF7 ç¢°è§å‡½æ•°å°±è·³ï¼ŒAlt+Shift+F7 åªè·³å…¥è‡ªå·±å†™çš„å‡½æ•°ï¼‰ => é€€å›žæ¥ï¼ˆshift + F8ï¼‰ => è·³åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼ˆF9ï¼‰

2. å¦‚æžœçœ‹ä¸æ˜Žç™½æ–‡ç« å†™çš„å†…å®¹çš„è¯ï¼Œè¾“å…¥ä¾‹å­ï¼Œè°ƒè¯•ä¸€éï¼ŒçŸ¥æ™“æ¯ä¸€æ­¥çš„æµç¨‹èƒ½è§£å†³ 80% çš„é—®é¢˜ã€‚å‰©ä¸‹çš„é—®é¢˜å¯ä»¥å¿½ç•¥ï¼Œå¯èƒ½æ˜¯åŸ‹çš„é›·ï¼ŒåŽæ–‡ä¼šæœ‰è§£é‡Šã€‚
3. Part 7 å’Œ Part 14 æ˜¯ä¸¤ä¸ªéš¾åº¦è·ƒè¿çš„ç« èŠ‚ï¼Œå…¶ä»–ç« èŠ‚éƒ½å¾ˆå¹³æ»‘ã€‚
4. å¦‚æžœçœ‹ä¸æ˜Žç™½æˆ–è€…æŽŒæŽ§ä¸ä½å¯ä»¥é‡æ–°å¼€å§‹ã€‚è¿™ä¸ä¼šè€½è¯¯å¾ˆå¤šæ—¶é—´ï¼Œæ°æ°ç›¸åå°±èƒ½æžå®šã€‚

> ä¾‹å¦‚æˆ‘çœ‹åˆ° Part 7 çš„æ—¶å€™å¡ä½äº†ï¼Œå¤§æ¦‚èŠ±äº†å››äº”å¤©çš„æ—¶é—´ã€‚ä½†æ˜¯ä»Žå¤´å¼€å§‹å†çœ‹åŠ ä¸Šé‡å†™ä»£ç ä¸€å¤©å°±æžå®šäº†ã€‚æ ¹æœ¬åŽŸå› åœ¨äºŽçœ‹çš„å¤ªå¿«å¿½è§†äº†å¾ˆå¤šç»†èŠ‚ï¼ä¹Ÿå°±æ˜¯æ€è€ƒçš„å°‘ã€‚

5. å»ºè®®æ ¹æ®é—®é¢˜è‡ªå·±å…ˆå®žçŽ°ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¦‚æžœå†™ä¸å‡ºæ¥å°±ç›´æŽ¥çœ‹ç­”æ¡ˆå§ï¼Œåˆ«æ­»ç£•æµªè´¹æ—¶é—´ã€‚åä¹‹å¦‚æžœå†™å‡ºæ¥äº†ï¼Œå†çœ‹ç­”æ¡ˆä¼šå‘çŽ°è‡ªå·±å†™çš„å¾ˆä¹±ï¼Œæœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰æƒ³åˆ°ï¼ŒæŽ¥ä¸‹æ¥é‡æž„å³å¯ã€‚

6. å¼€å§‹çš„æ—¶å€™è¯­æ³•æ ‘å¾ˆç®€å•ï¼Œä½†æ˜¯åŽç»­å°±å¾ˆå¤æ‚äº†ï¼Œå¯ä»¥ç»“åˆç€è°ƒè¯•å™¨æ¥åˆ†æžã€‚ä¸€å®šè¦ç»“åˆç€å›¾æ¥çœ‹ï¼ŒçŸ¥æ™“æ¯ä¸€æ­¥çš„ç›®çš„ï¼Œä¸ç„¶å¤ªæŠ½è±¡ã€‚ä¹Ÿå°±æ˜¯è§£é‡Šå™¨ä»£ç ï¼ˆPythonï¼‰ï¼Œè¯­æ³•æ ‘å›¾ç‰‡å’Œè¢«è§£é‡Šçš„æºç ï¼ˆPascalï¼‰ä¸‰è€…ä¹‹é—´çš„æ˜ å°„è¦ç†è§£åˆ°ä½ã€‚

# Part 1

é¦–å…ˆå®šä¹‰å­—ç¬¦ä¸²å˜é‡ï¼Œæ–¹ä¾¿åŽç»­æ“ä½œï¼Œå«ä¹‰å°±æ˜¯å­—é¢æ„æ€ã€‚

```python
EOF, INTEGER, PLUS = 'EOF', 'INTEGER', 'PLUS'
```

## 1. Token ç±»

é¦–å…ˆè¦æ˜Žç™½ç¼–è¯‘åŽŸç†ä¸­çš„ token æ˜¯ä»€ä¹ˆï¼Œä¸­æ–‡æ„æ€æ˜¯æ ‡è®°ã€‚

> ä¾‹å¦‚ 1+2 ä¸­å«æœ‰ä¸‰ä¸ª token : 1, +, 2 ã€‚å…¶ä¸­ 1ï¼Œ2 éƒ½æ˜¯ INTEGER ç±»åž‹ï¼Œè€Œ + åˆ™æ˜¯ PLUS ç±»åž‹ã€‚

é‚£ä¹ˆæŠ½è±¡å‡ºæ¥çš„ Token ç±»å°±ä¼šæœ‰ç±»åž‹å’Œå¯¹åº”çš„å€¼ä¸¤ä¸ªå±žæ€§ã€‚æž„é€ å‡½æ•°å¦‚ä¸‹ï¼š

```python
class Token(object):
    def __init__(self, type, value):
        self.type = type
        self.value = value
```

åœ¨æ­¤ä¹‹å‰éœ€è¦ä»‹ç»ä¸€ä¸‹é­”æ³•æ–¹æ³•ã€‚ç±»ä¼¼äºŽ `__xxxx__()` è¿™ç§ç±»åž‹çš„æ–¹æ³•éƒ½è¢«ç§°ä½œé­”æ³•æ–¹æ³•ã€‚

å½“ä½¿ç”¨ print è¾“å‡ºå¯¹è±¡çš„æ—¶å€™ï¼Œåªè¦è‡ªå·±å®šä¹‰äº†__str__(self) æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šæ‰“å°ä»Žåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ return çš„æ•°æ®ã€‚åä¹‹æ‰“å°çš„åˆ™æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚

æ›´å¤šé­”æ³•æ–¹æ³•ç›¸å…³å†…å®¹å¯æŸ¥çœ‹ï¼š[è‹±æ–‡ç‰ˆ](https://rszalski.github.io/magicmethods/) / [ä¸­æ–‡ç‰ˆ](https://pycoders-weekly-chinese.readthedocs.io/en/latest/issue6/a-guide-to-pythons-magic-methods.html) ã€‚

é™¤æ­¤ä¹‹å¤– Token ç±»ä¸­è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°ã€‚éƒ½æ˜¯ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼

```python
    def __str__(self):
        return "Token({type},{value})".format(
            type=self.type,
            value=repr(self.value)
        )

    def __repr__(self):
        return self.__str__()
```

ä¸Šé¢è¿™ä¸¤ä¸ªå‡½æ•°å¦‚æžœæ²¡è§è¿‡å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ã€‚ä¸è¿‡è¿™ä¸ªä¸é‡è¦ï¼Œä¸‹é¢æ˜¯åŒºåˆ«ï¼Œäº†è§£å³å¯ã€‚

__repr__ ç›®çš„æ˜¯ä¸ºäº†è¡¨ç¤ºæ¸…æ¥šï¼Œæ˜¯ä¸ºå¼€å‘è€…å‡†å¤‡çš„ã€‚

__str__ ç›®çš„æ˜¯å¯è¯»æ€§å¥½ï¼Œæ˜¯ä¸ºä½¿ç”¨è€…å‡†å¤‡çš„ã€‚

__str__ å®žé™…ä¸Šè°ƒç”¨äº† __repr__ ã€‚

å…·ä½“å¯å‚è€ƒ[Pythonçš„ä¸¤ä¸ªé­”æ³•æ–¹æ³•ï¼š__repr__å’Œ__str__](https://blog.csdn.net/sinat_41104353/article/details/79254149)ã€‚

## 2. ä¸»å‡½æ•°

æˆ‘è§‰å¾—åœ¨æè¿°è§£é‡Šå™¨ç±»ä¹‹å‰æœ‰å¿…è¦çŸ¥æ™“æµç¨‹ï¼Œä¹Ÿå°±æ˜¯ä¸»å‡½æ•° main ã€‚

```python
def main():
    while True:
        text = input('cin> ')
        interpreter = Interpreter(text)
        result = interpreter.expr()
        print(result)

if __name__ == "__main__":
    main()
```

å†™æˆæ­»å¾ªçŽ¯æ˜¯ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œè¾“å…¥ä¸€ä¸ªç»“æžœè¾“å‡ºä¸€ä¸ªç»“æžœã€‚

é¦–å…ˆè¾“å…¥å­—ç¬¦ä¸²ï¼ˆtextï¼‰ï¼Œæ ¹æ®å­—ç¬¦ä¸²æž„é€ ä¸€ä¸ªè§£é‡Šå™¨ï¼ˆInterpreterï¼‰å¯¹è±¡ï¼Œç„¶åŽè°ƒç”¨æˆå‘˜æ–¹æ³•æ¥è§£æžå­—ç¬¦ä¸²å†…å®¹ã€‚

è¾“å…¥çš„å­—ç¬¦ä¸²æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼ã€‚æµ‹è¯•å¦‚ä¸‹ï¼š

```python
cin> 5+6
10
cin> 6+6
12
cin> 7+7
14
cin> 
```

## 3. Interpreter

è¯¥ç±»æ˜¯ä¸»è¦æµç¨‹ï¼Œè§£å†³äº†å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Token å¹¶è®¡ç®—å…¶ç»“æžœã€‚

å› ä¸ºçŽ°åœ¨åªå¤„ç†ä¸€ä¸ªç®€å•çš„é€»è¾‘ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½å†™åˆ°äº†è¿™ä¸ªç±»é‡Œé¢ï¼ŒåŽç»­æ‰©å±•åŽä¼šå‰¥ç¦»æ¨¡å—ã€‚

é‡Œé¢å…±æœ‰å››ä¸ªå‡½æ•°ï¼ˆ`__init__`ã€`error`ï¼Œ`get_next_token`ï¼Œ`expr`ï¼‰ï¼Œç¬¬ä¸€ä¸ªæ˜¯æž„é€ å‡½æ•°ã€‚

å…ˆçœ‹æž„é€ å‡½æ•° `__init__` ï¼Œç„¶åŽçœ‹ `expr` çŸ¥é“è°ƒç”¨é¡ºåºã€‚

```python
class Interpreter():
    def __init__(self, text):
        # å­˜å‚¨å®Œæ•´å­—ç¬¦
        self.text = text
        # æŒ‡å‘å½“å‰æ‰€æ‰«æçš„å­—ç¬¦
        self.pos = 0
        # æŒ‡å‘å½“å‰æ‰€æ‹¿åˆ°äº† token
        self.current_token = None

    def error(self):
        return Exception("Error parsing input")


    def get_next_token(self):
        """è¿”å›žå€¼ Token ï¼Œå°† pos æŒ‡å‘çš„å€¼å˜ä¸º Token"""
        text = self.text

        if self.pos > len(text) - 1:
            return Token(EOF, None)

        current_char = self.text[self.pos]

        if current_char.isdigit():
            self.pos += 1
            return Token(INTEGER, int(current_char))

        if current_char == '+':
            self.pos += 1
            return Token(PLUS, '+')

        self.error()

    def expr(self):
        """æ‹¿åˆ°å½“å‰æ‰«æåˆ°çš„ Token åºåˆ—"""
        left = self.get_next_token()
        op = self.get_next_token()
        right = self.get_next_token()

        return left.value + right.value
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œexpr å‡½æ•°åªèƒ½å¤„ç†ä¸€ä½æ•´æ•°çš„åŠ æ³•æ“ä½œ

æŽ¥ä¸‹æ¥å¼€å§‹è¿›åŒ–ï¼è¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥å¾ˆå•è–„ï¼Œåœ¨è¯¥ç±»ä¸­å¢žåŠ ä¸€ä¸ª eat å‡½æ•°ã€‚
ç›®çš„æ˜¯ä¸ºäº†éªŒè¯å½“å‰å‡½æ•°ç±»åž‹å¹¶æ‹¿åˆ°ä¸‹ä¸€ä¸ªå‡½æ•°çš„ Token ã€‚

å‡½æ•°å˜åŠ¨å¦‚ä¸‹ï¼š

```python
    def eat(self,token_type):

        if self.current_token.type == token_type:
            self.current_token = self.get_next_token()
        else:
            self.error()

    def expr(self):
        # æ‹¿åˆ°å½“å‰æ‰«æåˆ°çš„ Token åºåˆ—

        self.current_token = self.get_next_token()
        left = self.current_token
        self.eat(INTEGER)

        op = self.current_token
        self.eat(PLUS)

        right = self.current_token
        self.eat(INTEGER)

        return left.value + right.value

```

ä½ å¯èƒ½ä¼šå¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆ eat å‡½æ•°è¦åŠ ä¸Š token_type å‚æ•°æ¥åšåˆ¤æ–­ã€‚è¯´å®žè¯æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ—¶å€™ä¹Ÿå¾ˆè¿·æƒ‘ï¼Œä½†æ˜¯åŽç»­å‘çŽ°è¿™æ ·åšå¾ˆæœ‰å¿…è¦ï¼å½“ç„¶åŽç»­ä¹Ÿä¼šå‡ºçŽ°ä¸åšéªŒè¯çš„ pos é€’å¢žå‡½æ•°ã€‚

è¿™æ ·åšçš„ç›®çš„æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†ä¿è¯æ‰€å†™ä»£ç ç¬¦åˆå®šä¹‰çš„æ–‡æ³•ã€‚ä¹Ÿå°±æ˜¯æ¥éªŒè¯æ˜¯å¦ç¬¦å·æ–‡æ³•å®šä¹‰ï¼Œå¦åˆ™å°±ä¸æŒ‰ç…§è¯¥åˆ†æ”¯èµ°ã€‚ç›®å‰çš„æ–‡æ³•å¾ˆç®€å•æ²¡æœ‰åˆ†æ”¯ï¼Œæ‰€ä»¥æ„Ÿå—ä¸åˆ°å­˜åœ¨çš„æ„ä¹‰ã€‚ä½†åŽç»­çš„æ–‡æ³•ä¼šå¾ˆå¤æ‚ï¼Œå­˜åœ¨å¤šä¸ªåˆ†æ”¯ï¼ŒéªŒè¯å°±æ˜¾å¾—å¾ˆæœ‰å¿…è¦äº†ã€‚çŽ°åœ¨ä¸ç†è§£ä¹Ÿæ— å¦¨ï¼Œç»§ç»­åšä¸‹åŽ»å°±æ˜Žç™½äº†ã€‚

å®Œæ•´ä»£ç ï¼š[part1](https://github.com/weijiew/lsbasi/blob/main/part1/calc1.py) ã€‚

> è‡³æ­¤ PART 1 ç»“æŸï¼Œå»ºè®®æ‰“å¼€ IDE è‡ªå·±é¡ºç€é€»è¾‘å†™ä¸€éï¼Œåº”è¯¥ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œé‡ç‚¹å…³æ³¨è¿™äº›é—®é¢˜ï¼

> å»ºè®®èƒ½å¤Ÿç‹¬ç«‹å†™å‡ºåŽå†å¼€å¯ä¸‹ä¸€ç« ï¼Œå¦åˆ™ä½ ä¾æ—§éœ€è¦å›žå¤´çœ‹ï¼Œå› ä¸ºå¾ˆå¤šä¸œè¥¿ä»…ä»…çœ‹ä¸€éç†è§£ä¸åˆ°ä½ï¼è¿™äº›ç¯‡æ–‡ç« æ­£æ˜¯æˆ‘åœ¨å›žå¤´çœ‹æ—¶å†™ä¸‹çš„ã€‚:) 

# Part 2

ä¹‹å‰çš„ä»£ç ä»…æ”¯æŒä¸¤ä¸ªä¸€ä½æ•´æ•°åŠ æ³•æ“ä½œï¼Œå’Œå®žé™…æƒ…å†µå·®åˆ«å¾ˆå¤§ã€‚æŽ¥ä¸‹æ¥çš„åŠŸèƒ½ä¸€ç‚¹ç‚¹æ·»åŠ ã€‚

é¦–å…ˆå®Œå–„å‡æ³•æ“ä½œã€‚è¿™ä¸ªé€»è¾‘å…¶å®žéžå¸¸ç®€å•ï¼ç…§ç€åŠ æ³•æ”¹å°±å¥½äº†ï¼Œå¯ä»¥è‡ªå·±æƒ³ç€å®žçŽ°ä¸€ä¸‹å†çœ‹ç­”æ¡ˆï¼

é¦–å…ˆå®šä¹‰å‡æ³•çš„å˜é‡ï¼Œå¢žåŠ å‡æ³•å…³é”®å­—çš„å®šä¹‰ã€‚

```python
EOF, PLUS, MINUS,INTEGER = 'EOF', 'PLUS', 'MINUS','INTEGER'
```

å¦‚ä½•å¤„ç†ç•¥è¿‡ç©ºæ ¼çš„é€»è¾‘ï¼Ÿ

åœ¨çœ‹ç­”æ¡ˆä¹‹å‰æˆ‘ä¹Ÿå®žçŽ°è¿‡å¤„ç†ç©ºæ ¼çš„é€»è¾‘ï¼Œä¿®æ”¹ get_next_token æ–¹æ³•å³å¯ã€‚æˆ‘çš„å®žçŽ°æ–¹å¼å¦‚ä¸‹ï¼š

```python
    def get_next_token(self):
        text = self.text

        if self.pos > len(text) - 1:
            return self.error()

        current_char = text[self.pos]

        while current_char == ' ':
            self.pos += 1
            current_char = self.text[self.pos]

        if current_char.isdigit():
            self.pos += 1
            return Token(INTEGER, int(current_char))

        if current_char == '+':
            self.pos += 1
            return Token(PLUS,'+')

        if current_char == '-':
            self.pos += 1
            return Token(MINUS, '-')

        self.error()
```

æµ‹è¯•å¦‚ä¸‹ï¼š

```python
calc2 > 5 + 5
10
calc2 > 5 - 5
0
calc2 >  5 + 5
10
```

ä½†æ˜¯ç­”æ¡ˆçš„å®žçŽ°æ–¹å¼å°±å¾ˆä¼˜é›…ï¼å’Œæˆ‘å†™çš„å·®åˆ«åœ¨äºŽå•ç‹¬å†™æˆå‡½æ•°äº†ï¼Œè¿˜åšäº†è¾¹ç•Œåˆ¤æ–­ã€‚

`skip_whitespace` æ–¹æ³•å®žçŽ°äº†è¶Šè¿‡ç©ºæ ¼ï¼Œå…¶ä¸­è°ƒç”¨äº† advace æ–¹æ³•ï¼Œè€Œè¯¥æ–¹æ³•æœ¬è´¨ä¸Šå°±æ˜¯é€’å¢ž pos ï¼Œåªä¸è¿‡åšäº†è¶Šç•Œå¤„ç†ã€‚advnce å°±æ˜¯ä¹‹å‰æåˆ°çš„ä¸å¸¦ç±»åž‹æ£€æŸ¥çš„ pos é€’å¢žå‡½æ•°ã€‚

```python
    def skip_whitespace(self):
        while self.current_char is not None and self.current_char.isspace():
            self.advance()

    def advance(self):
        self.pos += 1
        if self.pos > len(self.text) - 1:
            self.current_char = None
        else:
            self.current_char = self.text[self.pos]
```

çœ‹äº†ä¸Šé¢çš„ä»£ç ä¼šå‘çŽ° `self.current_char` å˜æˆäº†æˆå‘˜å˜é‡ï¼Œä¹‹å‰æ˜¯å†™åœ¨ get_net_token æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ã€‚

å› ä¸ºå¤šä¸ªå‡½æ•°éƒ½è¦ç”¨ï¼Œå¦‚æžœè¿˜æ˜¯å±€éƒ¨å˜é‡çš„è¯éœ€è¦ä¼ å‚ï¼Œç´¢æ€§æ”¹æˆæˆå‘˜å˜é‡ã€‚å°† current_char æ”¾å…¥æˆå‘˜å˜é‡ä¸­ã€‚

```python
class Interpreter(object):
    def __init__(self, text):
        self.text = text
        self.pos = 0
        self.current_token = None
        self.current_char = self.text[self.pos]
```

æŽ¥ä¸‹æ¥å°±æ˜¯ä¿®æ”¹ get_next_token äº†ï¼š

```python
    def get_next_token(self):

        while self.current_char is not None:

            # å…ˆå¤„ç†ç©ºæ ¼é€»è¾‘
            if self.current_char.isspace():
                self.skip_whitespace()
                continue

            if self.current_char.isdigit():
                return Token(INTEGER, self.integer())

            if self.current_char == '+':
                self.advance()
                return Token(PLUS,'+')

            if self.current_char == '-':
                self.advance()
                return Token(MINUS, '-')

            self.error()

        return Token(EOF, None)
```

å®Œæ•´ä»£ç å¯å‚è€ƒï¼š[calc2.py](https://github.com/weijiew/lsbasi/blob/main/part2/calc2.py)

> ä»¥ä¸Šå°±èƒ½å¤Ÿå¤„ç†å¤šä½æ•´æ•°åŠ å‡æ³•ï¼Œè·³è¿‡ç©ºæ ¼çš„åŠŸèƒ½ã€‚
> ä½†æ˜¯ç›®å‰åªèƒ½å¤„ç†ä¸¤ä¸ªæ•´æ•°åŠ å‡æ³•ï¼Œæ— æ³•å¤„ç†å¤šä¸ªæ•´æ•°åŠ å‡æ³•ï¼ä¾‹å¦‚ 1 + 2 + 3 + 4 ã€‚
> å…¶å®žæŽ¥ä¸‹æ¥å°±æ˜¯åœ¨ expr å‡½æ•°ä¸Šåšæ–‡ç« ï¼Œè¿™ä¸ªé€»è¾‘æ˜¯å†™æ­»çš„ï¼Œå¾ˆä¸å‹å¥½ã€‚

# Part 3

æ”¯æŒå¤šä¸ªå¤šä½æ•´æ•°åŠ å‡æ³•ã€‚

çœ‹ä¸‹è¾¹çš„ä¾‹å­ï¼Œå…¶å®žæ˜¯æœ‰è§„å¾‹çš„ï¼Œæ¯æ¬¡å¢žåŠ çš„éƒ½æ˜¯ä¸€ä¸ªç¬¦å·å’Œä¸€ä¸ªæ•´æ•°ã€‚

> 1 + 2
> 1 + 2 + 3
> 1 + 2 + 3 + 4

æ‰€ä»¥å°† expr å‡½æ•°æ”¹æˆå¾ªçŽ¯å³å¯ï¼

```python
    def expr(self):

        self.current_token = self.get_next_token()
        result = self.current_token.value
        self.eat(INTEGER)

        while self.current_token.type in (PLUS, MINUS):
            op = self.current_token
            if op.type == PLUS:
                self.eat(PLUS)
                result = result + self.current_token.value
                self.eat(INTEGER)
            elif op.type == MINUS:
                self.eat(MINUS)
                result = result - self.current_token.value
                self.eat(INTEGER)

        return result
```

ç­”æ¡ˆçš„å°†ä¸€äº›å†—ä½™æ“ä½œå°è£…æˆå‡½æ•°äº†ï¼Œæ¯”è¾ƒç®€æ´ã€‚

```python
    def term(self):
        token = self.current_token
        self.eat(INTEGER)
        return token.value

    def expr(self):

        self.current_token = self.get_next_token()
        result = self.term()

        while self.current_token.type in (PLUS, MINUS):
            op = self.current_token
            if op.type == PLUS:
                self.eat(PLUS)
                result = result + self.term()
            elif op.type == MINUS:
                self.eat(MINUS)
                result = result - self.term()

        return result
```

# Part 4

å•çº¯çš„ä¹˜é™¤æ˜¯å¾ˆç®€å•çš„ï¼Œå°†åŠ å‡æ”¹ä¸ºä¹˜é™¤å³å¯ï¼è¿™ä¸ªé€»è¾‘å¾ˆç®€å•ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒInterpreter ç±»å·²ç»éžå¸¸è‡ƒè‚¿äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåˆ›å»ºäº†ä¸€ä¸ªè§£æžè¯æ³•åˆ†æžå™¨ç±» lexer ã€‚
è¯¥ç±»è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º token ï¼Œå•ç‹¬è´Ÿè´£è¯¥åŠŸèƒ½ã€‚

ç›´æŽ¥çœ‹ä»£ç å§ï¼ŒæŒºç®€å•çš„ï¼Œå°±æ˜¯å°† lexer å‰¥ç¦»å‡ºæ¥ã€‚

æ­¤æ—¶é‡æ–°æ¢³ç†ä¸€ä¸‹ï¼ lexer å°†å¤„ç† token çš„é€»è¾‘å°è£…äº†èµ·æ¥ã€‚ä¾‹å¦‚è·³è¿‡ç©ºæ ¼ï¼Œå¤šä½æ•´æ•°å¤„ç†ã€‚ä»ŽæŠ½è±¡çš„è§’åº¦å°†æˆ‘ä»¬åªéœ€è¦æ˜Žç™½è¾“å‡ºæ˜¯ token å³å¯ã€‚è€Œ Interpreter åˆ™ä¸“æ³¨äºŽå¤„ç†ä¹˜é™¤çš„é€»è¾‘ã€‚

è¿™ä¸€èŠ‚ä»£ç å¾ˆç®€å•ï¼Œä½†æ˜¯åŠ å‡ä¹˜é™¤æ··åˆå°±ä¸ç®€å•äº†ï¼Œå› ä¸ºå­˜åœ¨ä¼˜å…ˆçº§ã€‚ä¸‹ä¸€èŠ‚å°±æ˜¯è®²è¿™ä¸ªçš„ï¼

# Part 5  

ä¼—æ‰€å‘¨çŸ¥ä¹˜é™¤çš„ä¼˜å…ˆçº§å¤§äºŽåŠ å‡ã€‚ä½“çŽ°åˆ°è¯­æ³•æ ‘ä¸­ï¼Œä¼˜å…ˆçº§è¶Šé«˜åˆ™èŠ‚ç‚¹æ‰€åœ¨æ ‘çš„å±‚æ•°å°±è¶Šä½Žã€‚

è¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼š

$$
expr: term((PLUS|MINUS)term)*
$$

$$
term: facter((MUL|DIV)facter)*
$$

$$
facter: INTEGER
$$

è¿™ä¸æ˜¯è¯æ³•åˆ†æžï¼Œè€Œæ˜¯åŽç»­è¦å…³æ³¨çš„äº‹æƒ…ï¼Œæ‰€ä»¥è¦å†™åœ¨ Interpreter ç±»ä¸­ã€‚

çŸ¥æ™“è¿™ä¸ªè¯­æ³•è§„åˆ™åŽï¼Œå¢žåŠ ä¸€ä¸ª expr å‡½æ•°å³å¯ã€‚è¯¥å‡½æ•°çš„é€»è¾‘å’Œ term å‡½æ•°å‡ ä¹Žä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯å¤„ç†åŠ å‡æ³•ã€‚å¯ä»¥å°è¯•ç€è‡ªå·±å†™ï¼Œç„¶åŽå›žå¤´æ¯”å¯¹ï¼Œå¾ˆç®€å•ï¼

å®žçŽ°ï¼š[calc5.py](https://github.com/weijiew/lsbasi/blob/main/part5/calc5.py) ã€‚

# Part 6

å¦‚ä½•å¤„ç†å·¦å³æ‹¬å·ï¼Ÿä¾‹å¦‚ `(1 + 2) * (3 + 4)` ï¼Œä¹‹å‰å› ä¸ºæ²¡æœ‰å¤„ç†æ‹¬å·çš„é€»è¾‘ï¼Œæ‰€ä»¥æ‰§è¡Œèµ·æ¥çœŸæ­£çš„é¡ºåºæ˜¯ `1 + 2 * 3 + 4` ã€‚

å°†å¤„ç†æ‹¬å·çš„è¯­æ³•åŠ å…¥è§„åˆ™ä¸­ï¼Œæ›´æ–°åŽçš„è¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼š

$$
expr: term((PLUS|MINUS)term)*
$$

$$
term: facter((MUL|DIV)facter)*
$$

$$
facter: INTEGER | LPAREN expr RPAREN
$$

è¿™ä¸ªå®žçŽ°èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œç…§ç€è¯­æ³•è§„åˆ™æ”¹å°±è¡Œäº†ã€‚

è‡³æ­¤å·²ç»é‡åˆ°é€’å½’ä¸‹é™åˆ†æžäº†ï¼Œä¹‹å‰æ„Ÿè§‰å¾ˆéš¾çš„ä¸œè¥¿æ²¡æƒ³åˆ°è¿™ä¹ˆç®€å•ã€‚å…¶å®žå°±æ˜¯ä¸€å †å‡½æ•°åµŒå¥—ï¼Œå†™å¥½æ–‡æ³•æ”¹æˆå‡½æ•°å³å¯ã€‚

å®žçŽ°ï¼š[calc6.py](https://github.com/weijiew/lsbasi/blob/main/part6/calc6.py) ã€‚

# Part 7 

è¿™ä¸€èŠ‚å¾ˆé‡è¦ï¼Œç•¥éš¾ï¼

å°†è¯­æ³•æ ‘æ”¹ä¸ºäº† AST ã€‚ä¸Žè¯­æ³•æ ‘ç›¸æ¯” AST çš„å¥½å¤„åœ¨äºŽæ›´ç®€æ´ã€‚

åœ¨æŠ½è±¡è¯­æ³•æ ‘ä¸­ï¼Œæ ¹æ®æ–‡æ³•çš„å®šä¹‰æ ‘èŠ‚ç‚¹å­˜åœ¨ä¸åŒç±»åž‹ã€‚ç›®å‰ä¸ºæ­¢åªæœ‰ BinOp å’Œ Num ä¸¤ç§ç±»åž‹ã€‚è¿™ä¸¤ä¸ªç±»ç»§æ‰¿è‡ª AST ç±»ã€‚è¿™ä¸ªä»”ç»†çœ‹ AST çš„å›¾ç¤ºæ˜¯å¯ä»¥æ˜Žç™½çš„ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™å¼ å›¾ï¼Œç›´æŽ¥å¼•ç”¨äº†ã€‚

![lsbasi_part7_astimpl_01](image/index/1641966164368.png)

æ‰€ä»¥ BinOp ç±»å­˜åœ¨å·¦å³ä¸¤ä¸ªèŠ‚ç‚¹ä»¥åŠä¸¤ä¸ªèŠ‚ç‚¹çš„æ“ä½œç¬¦ä¸‰ä¸ªå‚æ•°ï¼Œå®žçŽ°äº†ä¸¤ä¸ªæ“ä½œæ•°ä½¿ç”¨ï¼ˆåŠ /å‡ï¼‰ã€‚

è€Œ Num åˆ™è¡¨ç¤ºæ“ä½œæ•°ã€‚

æŽ¥ä¸‹æ¥è¦å®žçŽ°æ˜¯éåŽ† AST è®¡ç®—ç»“æžœäº†ã€‚ä¹‹å‰åªéœ€è¦æž„å»ºå‡º AST å³å¯ã€‚

è¿™è¡Œä»£ç ä¸€å®šè¦ç†è§£ `visitor = getattr(self, method_name, self.generic_visit)`

è¾“å…¥æ˜¯ method_name ï¼Œä¹Ÿå°±æ˜¯èŠ‚ç‚¹åå­—ï¼Œæ ¹æ®åå­—æ‰¾åˆ°è¦å¤„ç†èŠ‚ç‚¹çš„å‡½æ•°å¹¶è¿”å›žã€‚åä¹‹å¦‚æžœæ‰¾ä¸åˆ°å°±è°ƒç”¨ generic_visit å‡½æ•°ç”¨äºŽæŠ›å‡ºå¼‚å¸¸ã€‚

æ€»è€Œè¨€ä¹‹ï¼šgetattr ä¸‰ä¸ªå‚æ•° a,b,c  å¯ä»¥å°† a ç†è§£ä¸ºå¯¹è±¡ï¼Œa.b ã€‚ å¦‚æžœæ²¡æœ‰ b å°±è¿”å›ž c ã€‚

è¾“å…¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ç„¶åŽä»¥ debug ä¸€éå°±æ˜Žç™½äº†ï¼Œä¾‹å¦‚ 5 + 6 ã€‚

ç›´æŽ¥çœ‹ä»£ç å§ï¼š[spi.py](https://github.com/weijiew/lsbasi/blob/main/part7/spi.py)

è¿™ä¸€èŠ‚å¢žåŠ äº†è®¿é—®è€…æ¨¡å¼ï¼Œé‡‡ç”¨è®¿é—®è€…æ¨¡å¼æ¥éåŽ† AST ã€‚

è¿™ä¸ªè¯´å®žè¯ç¬¬ä¸€æ¬¡æŽ¥è§¦çš„æ—¶å€™æ˜¯å¾ˆæ‡µçš„ã€‚ä¹ŸæŸ¥äº†ä¸å°‘èµ„æ–™å¯¹äºŽè®¿é—®è€…æ¨¡å¼éƒ½æ²¡æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†è§£ï¼Œæœ‰çš„äººè¯´è¿™æ˜¯ 23 ç§è®¾è®¡æ¨¡å¼ç§æ¯”è¾ƒå¤æ‚çš„ä¸€ç§ï¼Œä¹Ÿæœ‰äººè¯´ç®€å•ï¼Œä½†æ˜¯çœŸæ­£ç†è§£ä¸‹æ¥å¥½åƒåˆä¸ç®€å•ã€‚å¥½å§ï¼Œè™½ç„¶æŸ¥äº†ä¸å°‘èµ„æ–™ä½†æ˜¯æˆ‘æ„Ÿè§‰è‡ªå·±ä¾æ—§æ²¡æœ‰ä¸€ä¸ªå¾ˆé€å½»çš„ç†è§£ã€‚è¿™ç‚¹å…¶å®žå½±å“ä¸å¤§ï¼Œä»£ç ä¸éš¾ç†è§£ï¼Œè·³è½¬é€»è¾‘å…¶å®žå¾ˆç®€å•ã€‚

è®¿é—®è€…æ¨¡å¼æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†æ›´å¥½çš„å¤ç”¨ä»£ç ï¼Œè¿™å¥½åƒæ˜¯åºŸè¯ :)ï¼Œè®¾è®¡æ¨¡å¼éƒ½æ˜¯ä¸ºäº†è¿™ä¸ªç›®çš„ã€‚ç„¶åŽæä¾›äº†ä¸åŒèŠ‚ç‚¹çš„å¤„ç†é€»è¾‘ï¼ŒåŽç»­å¢žåŠ èŠ‚ç‚¹åªéœ€è¦å†™æ–°çš„å‡½æ•°å³å¯ï¼Œä¸éœ€è¦ä¿®æ”¹æ¡†æž¶ä»£ç ã€‚æˆ‘è§‰å¾—æ˜Žç™½è¿™ä¸€ç‚¹å…¶å®žå°±å·®ä¸å¤šäº†ï¼Œå¹¶ä¸å½±å“åŽç»­çš„åº”ç”¨ã€‚

æœ€åŽï¼Œè¿™ä¸€èŠ‚ä¸€å®šè¦ debug ä¸€éã€‚å¯ä»¥æŒ‰ç…§å›¾ç¤ºçš„ `2 * 7 + 3` èµ°ä¸€éã€‚å»ºè®®å¤šè¯•å‡ ä¸ªä¾‹å­ï¼Œç»“åˆç€è¯­æ³•æ ‘åŠ æ·±ç†è§£ã€‚

# Part 8

å¢žåŠ äº† `-1`ï¼Œ`- -1`ï¼Œ`1 - - 2` çš„å¤„ç†ï¼Œè¿™ç§è¡¨è¾¾å¼è¢«ç§°ä½œä¸€å…ƒè¡¨è¾¾å¼ã€‚

å¯¹äºŽä¸€å…ƒè¡¨è¾¾å¼è€Œè¨€éœ€è¦å¢žåŠ æ–°çš„ AST èŠ‚ç‚¹æ¥å¤„ç†ï¼Œå› ä¸ºä¹‹å‰çš„ä¸¤ç§ç±»åž‹çš„èŠ‚ç‚¹å·²ç»ä¸é€‚åˆäº†ã€‚
å¦‚ä½•ä½ å¯¹ä¸Šä¸€èŠ‚ç†è§£çš„è¿˜å¯ä»¥ï¼Œé‚£ä¹ˆè¿™ä¸€èŠ‚åšä¸‹æ¥å°±å¾ˆé¡ºç•…ï¼å¿«é€Ÿé€šè¿‡å§ã€‚

é¦–å…ˆè¦åŠ ä¸Šä¸€å…ƒè¡¨è¾¾å¼çš„ç±»ï¼Œç„¶åŽæ›´æ–°æ–‡æ³•ï¼Œæœ€åŽå¢žåŠ è¯¥ç±»çš„å¤„ç†é€»è¾‘ã€‚

æˆ‘æ˜¯åœ¨ win10 ä¸‹ç”¨ pycharm å†™ä»£ç çš„ï¼Œä½†æ˜¯ win10 å®‰è£… free pascal åŽå‡ºçŽ°äº†ä¸å…¼å®¹çš„é—®é¢˜ã€‚
æˆ‘æ‹…å¿ƒåœ¨é…çŽ¯å¢ƒä¸ŠèŠ±è´¹å¤ªå¤šæ—¶é—´äºŽæ˜¯é‡‡ç”¨ WSL æ¥ç¼–è¯‘ä»£ç ã€‚ä¹Ÿå°±æ˜¯ Ubuntu 20.04 LTS ï¼Œè£…ä¸€ä¸ª Pascal è§£é‡Šå™¨å°±å¥½äº†ï¼Œä¸€è¡Œå‘½ä»¤æžå®šã€‚è¿™ç‚¹ä¸é‡è¦ï¼Œåªæ˜¯éªŒè¯ä»£ç ç»“æžœè€Œå·²ã€‚Pascal çš„ç¼–è¯‘çŽ¯å¢ƒç”¨çº ç»“ï¼Œå¯ä»¥ç•¥è¿‡ã€‚

ä»£ç ï¼š[part8](https://github.com/weijiew/lsbasi/blob/main/part8/spi.py) ã€‚
# Part 9 

æˆ‘åœ¨å†™ä»£ç çš„æ—¶å€™æ„Ÿè§‰è‡ªå·±å†™çš„ä»£ç å¾ˆä¹±ï¼Œæœ‰å¿…è¦çœ‹ä¸€ä¸‹ Python ä»£ç è§„èŒƒã€‚

ä¸‹é¢æ˜¯æˆ‘å‚è€ƒçš„èµ„æºï¼š[Google Python Style Guide](https://google.github.io/styleguide/pyguide.html) / [ä¸­æ–‡ç‰ˆ](https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/python_style_rules/)

è¿™ä¸€èŠ‚æ­£å¼è¿ˆå…¥äº† Pascal çš„å¤§é—¨ï¼Œå¼€å§‹è¦å¤„ç†ä¸Žä¹‹ç›¸å…³çš„å…³é”®å­—äº†ã€‚ä¹‹å‰çš„éƒ¨åˆ†ä»…ä»…æ˜¯ç®—æœ¯è¡¨è¾¾å¼çš„å¤„ç†ï¼Œä½†è¿™å´æ˜¯é€šç”¨çš„ã€‚

è¿™ä¸€èŠ‚çœ‹èµ·æ¥è™½ç„¶å¾ˆå¤šï¼Œä½†å…¶å®žä¹Ÿå¾ˆç®€å•ã€‚é¦–å…ˆç»“åˆäº†ä½œè€…ç”»çš„å›¾æ¥ç†è§£æ–‡æ³•ï¼Œç„¶åŽå°†æ–‡æ³•è½¬æ¢æˆä»£ç å³å¯ã€‚å›¾å¾ˆé‡è¦ï¼Œå»ºè®®å¤šçœ‹å‡ éã€‚æ¢³ç†å¥½é€»è¾‘åŽå†å¼€å§‹å†™ã€‚

é™¤æ­¤ä¹‹å¤–è¿™ä¸€èŠ‚ä¹Ÿå¼€å§‹å¼•å…¥ç¬¦å·è¡¨çš„é›å½¢äº†ã€‚

# Part 10 

* æ”¯æŒè§£æž Pascal header ã€‚
* æ”¯æŒè§£æžå˜é‡å£°æ˜Žã€‚
* é‡‡ç”¨ div æ¥åšæ•´æ•°é™¤æ³•ï¼Œé‡‡ç”¨ / æ¥åšæµ®ç‚¹æ•°é™¤æ³•ã€‚
* æ”¯æŒ Pascal æ³¨é‡Šã€‚

å†™ä»£ç çš„æ—¶å€™åˆ‡è®°å¯¹ç€è¯­æ³•æµç¨‹å›¾çœ‹ï¼Œç„¶åŽè½å®žåˆ°å…·ä½“çš„ Pascal ä»£ç ä¸Šï¼Œåå¤æ¯”å¯¹ã€‚å¦‚æžœåªçœ‹ä»£ç å¯èƒ½æ— æ³•ç†è§£ã€‚

# Part 11 

å¼•å…¥äº†ç¬¦å·è¡¨ã€‚è¿™ä¸€èŠ‚ä¼šæœ‰ä¸€äº›ä¸ç†è§£çš„ä¸œè¥¿ï¼ŒPart 13 è¿˜ä¼šé‡æ–°è§£é‡Šï¼Œä¸ç”¨æ‹…å¿ƒã€‚

# Part 12

è¿™ä¸€èŠ‚å¾ˆç®€å•ï¼Œå¢žåŠ äº†æ–°çš„è¯­æ³•è§„åˆ™ï¼Œå®Œå–„ä»£ç å³å¯ã€‚å¿«é€Ÿé€šè¿‡ã€‚
# Part 13

é™¤äº†æ–‡ä¸­æåˆ°çš„æ”¹åŠ¨ï¼Œè¿˜åœ¨å‡½æ•° _id å¤„åšäº†ä¸€ä¸ªå¤§å°å†™è½¬æ¢ï¼Œå°å†™å…³é”®å­—ä¸€å¾‹è½¬ä¸ºå¤§å†™ã€‚ä¸ä¿®æ”¹çš„è¯è·‘ä¸èµ·æ¥ã€‚

`token = RESERVED_KEYWORDS.get(result.upper(), Token(ID, result))`

é‡‡ç”¨ä¸‰ä¸ªé—®é¢˜æ¥å¼•å‡ºè¦æ”¹åŠ¨çš„å†…å®¹ã€‚è¯¦ç»†è§£é‡Šäº† Part 11 çš„ç–‘é—®ã€‚

1. ç¬¦å·è¡¨è¦æ”¶é›†ä»€ä¹ˆå†…å®¹ï¼Ÿç¬¦å·çš„åå­—ï¼Œç±»åž‹ã€‚
2. ç¬¦å·è¡¨å¦‚ä½•å­˜å‚¨ï¼Ÿå­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚
3. æ€Žä¹ˆæœé›†ï¼ŸæŒ‰ç…§è®¿é—®è€…æ¨¡å¼éåŽ† AST ï¼Œå¢žåŠ æ–°çš„é€»è¾‘å³å¯ã€‚

è¿™ä¸€èŠ‚å†…å®¹å¾ˆé•¿ï¼Œè€ç€æ€§å­çœ‹å§ï¼Œæˆ‘åœ¨è¿™ä¸€èŠ‚èŠ±äº†ä¸å°‘æ—¶é—´ã€‚å…¶å®žä¸éš¾ï¼Œéœ€è¦è€å¿ƒã€‚

# Part 14  

å¥½å®¶ä¼™ï¼Œè¿™ä¸€èŠ‚æ¯”ä¸Šä¸€èŠ‚è¦é•¿çš„å¤šã€‚è€Œä¸”è¿˜éš¾ï¼Œåšå¥½å¿ƒé‡Œå‡†å¤‡ã€‚

ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯æœ€éš¾çš„ä¸€èŠ‚äº†ã€‚

æµ‹è¯• scope02 æ—¶å¦‚æžœå‡ºé”™æ³¨æ„ä¿®æ”¹ ScopedSymbolTable ç±»ä¸­çš„ lookup å‡½æ•°ä»¥åŠæž„é€ å‡½æ•°ã€‚

æŠŠæ¯æ¬¡ä»£ç çš„æ”¹åŠ¨å¼„æ˜Žç™½å°± ok äº†ã€‚

å»ºè®®å°†è¯­æ³•æ ‘ç”Ÿæˆå‡ºæ¥ï¼Œç„¶åŽç…§ç€è¯­æ³•æ ‘ debug åˆ†æžã€‚è¿™æ ·ä¼šçœäº‹ä¸å°‘ï¼Œå› ä¸ºèŠ‚ç‚¹å¾ˆå¤šè„‘å­è£…ä¸ä¸‹äº†ã€‚ðŸ¤£

å›¾ç‰‡æˆ‘æ˜¯ç”¨ WSL å†…åµŒä¸€ä¸ª Ubuntu 20.04 LTS ç³»ç»Ÿè·‘å‡ºæ¥çš„è¯­æ³•æ ‘å›¾ç‰‡ï¼Œå› ä¸º win ä¸‹ä¸è¯†åˆ« dot ã€‚è¿™ä¸ªç½‘ä¸Šæœ‰è§£å†³æ–¹æ¡ˆï¼Œç›´æŽ¥æœæŠ¥é”™åº”è¯¥å°±èƒ½æžå®šã€‚æˆ‘å«Œéº»çƒ¦å°±ç›´æŽ¥ç”¨ WSL è·‘äº†ã€‚

è¿™ä¸€èŠ‚ä¸»è¦ä»‹ç»ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å‡½æ•°ã€‚å‡½æ•°åµŒå¥—ä¸‹çš„ç¬¦å·è¡¨å¦‚ä½•ç®¡ç†ï¼ŒéåŽ†çš„ä½œç”¨åŸŸèŒƒå›´å¦‚ä½•å¤„ç†ç­‰ç­‰ã€‚æ–‡ç« é•¿æ˜¯å› ä¸ºä½œè€…åšäº†å¾ˆå¤šè§£é‡Šï¼Œä»£ç æ”¹åŠ¨å…¶å®žä¸æ˜¯å¤ªå¤šæ˜¯ðŸ˜‚ï¼Œæ…¢æ…¢çœ‹å§ã€‚

# Part 15

è¿™æ˜¯æœ€ç´¯çš„ä¸€èŠ‚ï¼Œæ”¹åŠ¨æ¯”è¾ƒå¤šã€‚æ–°ä¸œè¥¿å€’æ˜¯ä¸å¤šï¼Œå°±æ˜¯ä»£ç å˜åŠ¨æ¯”è¾ƒå¤šã€‚åŠ¨æ‰‹å§ï¼

å¢žåŠ äº†æŠ¥é”™å¤„ç†ï¼Œå‡ ä¹Žé‡æž„äº†ä»£ç ï¼Œæ»¡å±éƒ½æ˜¯æŠ¥é”™ã€‚

# Part 16

å¼•å…¥äº†è°ƒç”¨å‡½æ•°çš„æ–‡æ³•ã€‚ä¸€è·¯ç‹‚å¥”å§ï¼Œæ²¡å¤šå°‘ä¸œè¥¿ï¼

# Part 17

åˆå¼€å§‹åŸ‹é›·äº†ï¼Œå’Œä¸‹ä¸€ç« æ˜¯ç»“åˆçš„ã€‚è¿™ç« è¯»èµ·æ¥ä¹Ÿéžå¸¸çš„å¿«ã€‚

# Part 18  

å¥½å§æˆ‘ï¼Œè§‰å¾—è¯¥æš‚åœäº†ã€‚åšè¿™ä¸ªé¡¹ç›®çš„ç›®çš„æ˜¯ä¸ºäº†å…¥é—¨ç¼–è¯‘åŽŸç†ï¼Œåº”å¯¹è€ƒè¯•ã€‚æˆ‘è®¤ä¸ºè¯¥å…¥é—¨çš„ç›®çš„å·²ç»è¾¾åˆ°ï¼Œä½†æ˜¯è¿˜è¦çœ‹ç‚¹è§†é¢‘æ¥åº”å¯¹è€ƒè¯•ï¼Œæ€»è€Œè¨€ä¹‹æ”¶èŽ·å¾ˆå¤šã€‚

æˆªè‡³ç›®å‰ï¼ˆ2021-02-20ï¼‰ä½œè€…æ›´æ–°åˆ°äº† 19 ç« ï¼Œè€Œä¸”è¿™ä¸ªç³»åˆ—è¿˜æ²¡æœ‰å®Œç»“ã€‚ä½œè€…æ˜¯æœ‰å‡ºä¹¦çš„æ‰“ç®—ï¼Œç­‰å‡ºç‰ˆäº†æˆ‘ä¸€å®šè¦ä¹°ä¸€æœ¬æ”¯æŒã€‚æ•´ä¸ªç³»åˆ—å†™çš„å¾ˆæ£’ï¼

# summary 

è¿™ä¸ªé¡¹ç›®ä½œä¸ºå…¥é—¨ç¼–è¯‘åŽŸç†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚æ”¶èŽ·å¾ˆå¤šï¼Œç»§ç»­åšä¸‹åŽ»æ„ä¹‰ä¸å¤§äº†ã€‚ç­‰ä½œè€…æ›´æ–°äº†å†ç»§ç»­ coding ã€‚

è¿™ä¸ªé¡¹ç›®å¾ˆæœ‰è¶£ï¼Œè¿™ç¯‡æ–‡ç« åŽç»­ä¸€å®šä¼šé‡å†™å®Œå–„ï¼Œä»£ç æˆ‘ä¼šé‡æž„çš„ã€‚

> å†™äºŽ 2021/02/20 05:04